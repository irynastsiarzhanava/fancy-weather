<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fancy Weather App</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/efee5868b2.js" crossorigin="anonymous"></script>
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js"></script>
  <style>
  #map { position: absolute; top: 0; bottom: 0; width: 100%; }
  </style>
<script defer src="main.js"></script></head>
<body>
  <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.min.js"></script>
  <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.css" type="text/css">
  <!-- Promise polyfill script required to use Mapbox GL Geocoder in IE 11 -->
  <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js">
  </script>
  <header>
    <button type="button" class="btn">
      <i>&#x21bb;</i>
    </button>
    <div class="dropdown">
      <button class="btn dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
        EN
      </button>
      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
        <li><a class="dropdown-item" href="#">RU</a></li>
        <li><a class="dropdown-item" href="#">PL</a></li>
      </ul>
    </div>
    <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
      <input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off" checked>
      <label class="btn btn-outline-primary" for="btnradio1">&#8451;</label>
    
      <input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
      <label class="btn btn-outline-primary" for="btnradio2">&#8457;</label>
    </div>
    <div class="input-group">
      <input type="text" class="form-control" placeholder="Search city">
      <div class="input-group-append">
        <button class="btn btn-secondary" type="button">
          <i class="fa fa-search"></i>
        </button>
      </div>
    </div>
  </header>
  <main>
    <section class="weather">
      <div class="location">
        <h1> <span id="city"></span>, <span id="country"></span></h1>
        <p><span id="date"></span><span id="time"></span></p>
        <div>
          <p class="temp"><span id="temp"></span>&#8451;</p>
          <figure><img id="icon" alt="Weather icon"></figure>
        </div>
        <div class="desc"><span id="desc"></span></div>
      </div>
      <div class="overcast">
        <h4>Overcast</h4>
        <p>Feels like: <span id="feels-like"></span>&#8451;</p>
        <p>Wind: <span id="wind"></span>m/s</p>
        <p>Humidity: <span id="humidity"></span>%</p>
      </div>
    </section>
    <section class="forecast">
      <h4>3 days forecast</h4>
      <div>
        <span id="day1"></span>
        <p><span id='temp-forecast-day1'></span>&#8451;</p>
        <figure><img id="icon-day1" alt="Weather icon"></figure>
      </div>
      <div>
        <span id="day2"></span>
        <p><span id='temp-forecast-day2'></span>&#8451;</p>
        <figure><img id="icon-day2" alt="Weather icon"></figure>
      </div>
      <div>
        <span id="day3"></span>
        <p><span id='temp-forecast-day3'></span>&#8451;</p>
        <figure><img id="icon-day3" alt="Weather icon"></figure>
      </div>
    </section>
    <section class="map">
      <div id="map"></div>
      <div>State: <span id="state"></span></div>
      <div>Postal: <span id="postal"></span></div>
      <div>Latitude: <span id="latitude"></span></div>
      <div>Longitude: <span id="longitude"></span></div>
      <div>IP address: <span id="ipv4"></span></div>  
    </section>
  </main>
  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoidmVyYXNpYXZrYSIsImEiOiJja3Fqc2I5bTMwaWdxMndwcW14eWo2azY0In0.wB2BrV0hfUKqD3hgs9rLog';
  var map = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/mapbox/streets-v11',
  center: [-79.4512, 43.6568],
  zoom: 8
  });
   
  /* Given a query in the form "lng, lat" or "lat, lng"
  * returns the matching geographic coordinate(s)
  * as search results in carmen geojson format,
  * https://github.com/mapbox/carmen/blob/master/carmen-geojson.md */
  var coordinatesGeocoder = function (query) {
  // Match anything which looks like
  // decimal degrees coordinate pair.
  var matches = query.match(
  /^[ ]*(?:Lat: )?(-?\d+\.?\d*)[, ]+(?:Lng: )?(-?\d+\.?\d*)[ ]*$/i
  );
  if (!matches) {
  return null;
  }
   
  function coordinateFeature(lng, lat) {
  return {
  center: [lng, lat],
  geometry: {
  type: 'Point',
  coordinates: [lng, lat]
  },
  place_name: 'Lat: ' + lat + ' Lng: ' + lng,
  place_type: ['coordinate'],
  properties: {},
  type: 'Feature'
  };
  }
   
  var coord1 = Number(matches[1]);
  var coord2 = Number(matches[2]);
  var geocodes = [];
   
  if (coord1 < -90 || coord1 > 90) {
  // must be lng, lat
  geocodes.push(coordinateFeature(coord1, coord2));
  }
   
  if (coord2 < -90 || coord2 > 90) {
  // must be lat, lng
  geocodes.push(coordinateFeature(coord2, coord1));
  }
   
  if (geocodes.length === 0) {
  // else could be either lng, lat or lat, lng
  geocodes.push(coordinateFeature(coord1, coord2));
  geocodes.push(coordinateFeature(coord2, coord1));
  }
   
  return geocodes;
  };
   
  // Add the control to the map.
  map.addControl(
  new MapboxGeocoder({
  accessToken: mapboxgl.accessToken,
  localGeocoder: coordinatesGeocoder,
  zoom: 4,
  placeholder: 'Try: -40, 170',
  mapboxgl: mapboxgl
  })
  );
  </script>
</body>
</html>